var X=Object.defineProperty;var $=(e,t,o)=>t in e?X(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o;var b=(e,t,o)=>($(e,typeof t!="symbol"?t+"":t,o),o);import{C as ee,r as c,a as N,B as te,a0 as z,M as se,V as E,a1 as oe,a2 as B,u as G,d as ne,j as H,b as p,c as U,a3 as re,T,F,a4 as ae,e as ie,f as ce}from"./index.1dfdb1ed.js";import{E as le,D as ue,B as me,N as he,V as pe}from"./index.3053eaa3.js";const xe=e=>(e%T+T)%T;class k extends re{constructor(o,r,a,i=0){super();b(this,"helixLength");b(this,"helixRadius");b(this,"helixWindingSeparation");b(this,"helixStartingAngleRad");this.helixLength=o,this.helixRadius=r,this.helixWindingSeparation=a,this.helixStartingAngleRad=xe(i)}getPoint(o,r=new E){o-=.5;const i=1/(this.helixLength/this.helixWindingSeparation),s=T*(o%i/i),g=this.helixRadius*Math.cos(s+this.helixStartingAngleRad),l=this.helixRadius*Math.sin(s+this.helixStartingAngleRad),M=this.helixLength*o;return r.set(g,l,M)}}const de=(e,t)=>Math.hypot(e*Math.sin(t),e*Math.cos(t)-e),j=({coordinateMapper:e,helixLength:t=10,helixWindingSeparation:o=10,helixRadius:r=1,strandRadius:a=.1,baseSpacing:i=.35,strandOffsetRad:s=Math.PI/2,mirrorEffects:g=!0,fixedBaseGap:l=!0,palette:M=U.THREE_RAINBOW,...A})=>{const f=Math.floor(t/i),x=ee.getPalette(M).buildLut(),m=c.exports.useRef(null),Q=c.exports.useMemo(()=>new N({color:"#606060"}),[x]),Z=c.exports.useMemo(()=>{const n=.45*de(r,s),d=new te(a,a,n,1);for(let h=0;h<d.attributes.position.count;h++)d.attributes.position.setZ(h,d.attributes.position.getZ(h)-n/2);return d.attributes.position.needsUpdate=!0,d},[r,a,s]),Y=c.exports.useRef(null),q=c.exports.useRef(null),I=c.exports.useMemo(()=>new N({color:x.getColor(.5)}),[x]),[O,J,_,K]=c.exports.useMemo(()=>{const S=new k(t,r,o,0),n=new k(t,r,o,s);return[S,new z(S,100,a,12,!1),n,new z(n,100,a,12,!1)]},[t,r,o,a,s]),u=c.exports.useMemo(()=>new se,[]),C=c.exports.useMemo(()=>new E,[]),P=c.exports.useMemo(()=>new E,[]),R=c.exports.useMemo(()=>new E,[]),v=c.exports.useMemo(()=>new oe,[]),L=c.exports.useMemo(()=>new E(0,0,1),[]);return c.exports.useEffect(()=>{let S=0;for(let n=0;n<f;n++){S=n/Math.max(f-1,1);const d=Math.floor(3.99*B.seededRandom(n)),h=3-d;O.getPoint(S,C),_.getPoint(S,P),u.setPosition(C),u.lookAt(C,P,L),m.current.setMatrixAt(n*2,u),m.current.setColorAt(n*2,x.getColor(d/3)),u.setPosition(P),u.lookAt(P,C,L),m.current.setMatrixAt(n*2+1,u),m.current.setColorAt(n*2+1,x.getColor(h/3))}m.current.instanceMatrix.needsUpdate=!0,m.current.instanceColor.needsUpdate=!0},[O,_,m,f,x]),G(({clock:S})=>{const n=S.getElapsedTime();let d=0,h=0,V=0,W=0;const y=.25,D=1;for(let w=0;w<f;w++)d=w/Math.max(f-1,1),h=e.map(ne.CARTESIAN_1D,g?2*Math.abs(d-.5):d,0,0,n)/e.amplitude,h=(1+h)/2,V=y+(l?2*h:h)*(D-y),W=l?y+2*(1-h)*(D-y):V,m.current.getMatrixAt(w*2,u),u.decompose(C,v,R),R.z=V,u.compose(C,v,R),m.current.setMatrixAt(w*2,u),m.current.getMatrixAt(w*2+1,u),u.decompose(P,v,R),R.z=W,u.compose(P,v,R),m.current.setMatrixAt(w*2+1,u);m.current.instanceMatrix.needsUpdate=!0}),H("group",{...A,children:[p("mesh",{ref:Y,geometry:J,material:I,castShadow:!0,receiveShadow:!0}),p("mesh",{ref:q,geometry:K,material:I,castShadow:!0,receiveShadow:!0}),p("instancedMesh",{ref:m,args:[Z,Q,2*f],castShadow:!0,receiveShadow:!0})]})},ge=({...e})=>{const r=Array.from({length:5}).map(i=>c.exports.useRef(null)),a=Array.from({length:5}).map((i,s)=>new E().fromArray(Array.from({length:3}).map((g,l)=>2*B.seededRandom(s+l)-1)).normalize().multiplyScalar(15));return G(({clock:i})=>{const s=i.getElapsedTime(),g=5e-4,l=.05;let M,A=0;r.forEach((f,x)=>{!f.current||(M=a[x],A=Math.sin(l*(.5+.5*B.seededRandom(x))*s+B.seededRandom(x)/l),f.current.position.set(M.x*A,M.y*A,M.z*A),f.current.rotation.z+=g*Math.cos((.5+.5*B.seededRandom(x))*s),f.current.rotation.y+=g*Math.cos((.5+.5*B.seededRandom(x))*s))})}),p(F,{children:r.map((i,s)=>p("group",{ref:i,position:a[s],rotation:new ae(...Array.from({length:3}).map((g,l)=>Math.PI*(2*B.seededRandom(s+l)-1))),children:p(j,{...e})},s))})},Me=({coordinateMapper:e,palette:t=U.THREE_COOL_TO_WARM})=>{const{multi:o,helixLength:r,helixRadius:a,helixWindingSeparation:i,strandRadius:s,baseSpacing:g,strandOffsetRad:l,mirrorEffects:M,fixedBaseGap:A}=ie({"Visual - DNA":ce({multi:!0,helixLength:{value:50,min:5,max:100,step:5},helixRadius:{value:1,min:1,max:5,step:1},helixWindingSeparation:{value:10,min:5,max:50,step:1},strandRadius:{value:.1,min:.1,max:.3,step:.1},baseSpacing:{value:.35,min:.1,max:2,step:.05},strandOffsetRad:{value:Math.PI/2,min:Math.PI/4,max:Math.PI,step:Math.PI/8},mirrorEffects:!0,fixedBaseGap:!1},{collapsed:!0})});return o?p(ge,{coordinateMapper:e,helixLength:r,helixRadius:a,helixWindingSeparation:i,strandRadius:s,baseSpacing:g,strandOffsetRad:l,mirrorEffects:M,fixedBaseGap:A,palette:t}):p(j,{coordinateMapper:e,helixLength:r,helixRadius:a,helixWindingSeparation:i,strandRadius:s,baseSpacing:g,strandOffsetRad:l,mirrorEffects:M,fixedBaseGap:A,palette:t})},we=({...e})=>H(F,{children:[p(Me,{...e}),H(le,{children:[p(ue,{focusDistance:0,focalLength:.02,bokehScale:3,height:480}),p(me,{luminanceThreshold:0,luminanceSmoothing:.9,height:300}),p(he,{opacity:.02}),p(pe,{eskil:!1,offset:.1,darkness:1.1})]})]});export{we as default};
